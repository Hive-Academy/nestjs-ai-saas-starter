

echo "🚀 Running pre-push checks..."

# Get the current branch
current_branch=$(git rev-parse --abbrev-ref HEAD)

# Only run checks if pushing to main or develop
if [ "$current_branch" = "main" ] || [ "$current_branch" = "develop" ]; then
  echo "🧪 Running tests for affected projects..."
  npx nx affected:test --base=origin/$current_branch

  echo "🔍 Running lint for affected projects..."
  npx nx affected:lint --base=origin/$current_branch

  echo "🏗️  Building affected projects..."
  npx nx affected:build --base=origin/$current_branch

  echo "📦 Testing publish process (dry run)..."
  npx nx affected --target=publish --dry-run --base=origin/$current_branch
fi

echo "✅ Pre-push checks passed!"
